library(AzureAuth) ## to connect with credentials
library(AzureStor) ## to access the stored data

## install azure cli: https://docs.microsoft.com/en-us/cli/azure/install-azure-cli-windows?tabs=azure-cli
## sign in to Azure using your AAD un/pw in the terminal/commandline: az login 
## get token in terminal/commandline: az account get-access-token --resource https://datacenterdc2datalake.blob.core.windows.net/

### define your token 
token = "eyJ0eXAiOiJKV1QiLCJhbGciOiJSUzI1NiIsIng1dCI6IjJaUXBKM1VwYmpBWVhZR2FYRUpsOGxWMFRPSSIsImtpZCI6IjJaUXBKM1VwYmpBWVhZR2FYRUpsOGxWMFRPSSJ9.eyJhdWQiOiJodHRwczovL2RhdGFjZW50ZXJkYzJkYXRhbGFrZS5ibG9iLmNvcmUud2luZG93cy5uZXQvIiwiaXNzIjoiaHR0cHM6Ly9zdHMud2luZG93cy5uZXQvNzQ5YzFmYmEtMmMyOS00YTBmLTg3ZGEtODc3NjQ3YmJiZDg2LyIsImlhdCI6MTY2Mzg2MDc0NywibmJmIjoxNjYzODYwNzQ3LCJleHAiOjE2NjM4NjYyMjUsImFjciI6IjEiLCJhaW8iOiJBVFFBeS84VEFBQUFURGtPbndRcjZGNFlMS2h4L1NoaThlMHlSYUdvRmlKNHZlL2ZEeDdtT0dsenRBVkgyVFZiYU0vazRpQU9Pd1dxIiwiYW1yIjpbInB3ZCJdLCJhcHBpZCI6IjA0YjA3Nzk1LThkZGItNDYxYS1iYmVlLTAyZjllMWJmN2I0NiIsImFwcGlkYWNyIjoiMCIsImZhbWlseV9uYW1lIjoiVG9tbGluIiwiZ2l2ZW5fbmFtZSI6IkhhbGVpZ2giLCJncm91cHMiOlsiNzcyYzQ3MWMtZTVkMy00ZWI0LWE2YTEtZGY5ZGVmOTYxZmVjIiwiYWQwOTQ4YWMtYWY2OC00NDk1LThjY2QtNDE0YzNjY2ZmMzczIl0sImlwYWRkciI6IjE3NC42Ny4xMjkuMTkiLCJuYW1lIjoiSGFsZWlnaCBUb21saW4iLCJvaWQiOiIxODk4MTI1My00MTY0LTQ5MjAtYTFiOS0xOWIwNjcxODA1ZjEiLCJwdWlkIjoiMTAwMzIwMDIxRUUwMzY0NyIsInJoIjoiMC5BU2tBdWgtY2RDa3NEMHFIMm9kMlI3dTlob0dtQnVUVTg2aENrTGJDc0NsSmV2RXBBSDguIiwic2NwIjoidXNlcl9pbXBlcnNvbmF0aW9uIiwic3ViIjoiejlNcXBEeWdRMW9yYUVnR3R0WVE3enl2NHMxVTlqY3B0UHc1LUJKMWZPZyIsInRpZCI6Ijc0OWMxZmJhLTJjMjktNGEwZi04N2RhLTg3NzY0N2JiYmQ4NiIsInVuaXF1ZV9uYW1lIjoiSGFsZWlnaHRAZGF0YWNlbnRlcnJlc2VhcmNoLm9yZyIsInVwbiI6IkhhbGVpZ2h0QGRhdGFjZW50ZXJyZXNlYXJjaC5vcmciLCJ1dGkiOiJFREozbTRMVEUwV2ZjSDhVN3pZWkFBIiwidmVyIjoiMS4wIn0.NWvgJHD98cSaApfpdixbChRpmCT-buAf7CVmrv8jzjZdM9LS4DEqr4SU0_x__PSgU49E6xa5-kI12Yh6NfdGlqadWDA-v6ODuCbkk9R_JM4cFTnKyAwXXeONhpO78jlhPCBTnlFl_Rly5Z3NgvUPFjGc7OZitjC9Rhvup9ZttrIZirCiYaZCQmk3YjpILRoxmsq1KdCCxB0xJMllQmM8MCLFa5ZdTkrVSZr-ezn67skhBfvI2OE8qLPxfOgIoI3krYv4oYWtmwRX6nKE0gLq8RVeE9MIhm7aLFw-c7RAP1wpZEWsxfv96xd0H4C5EtgbBFLOYG98tPX9bkEMyqWgvA"
# delete token before pushing to github

ad_endp_tok2 <- storage_endpoint("https://datacenterdc2datalake.blob.core.windows.net/", token=token) ## again, the rsource/URL

## Connections to some most-used containers.
cont_proj <- storage_container(ad_endp_tok2, "project") 
df <- storage_read_csv(cont_proj, "who_lives/2022/WhoLives_longer.csv") %>% select(-1) #make sure this is updated within datalake - querying_WhoLives_factconsolidated

